# 缓存穿透

### 2018-4-28

使用缓存的程序代码执行的逻辑通常是先根据某个key从缓存中查数据，如果查不到，在从数据库里查，然后将查到的数据写如缓存。 
 
如果从数据库里也查不到，我们就会返回一个空的结果。 那么， 如果下次在通过这个key查询数据， 这个流程还是会走一遍， 先查缓存， 再差数据库， 仍旧没有查到结果， 返回空值。 也就是说，查询数据库的那一步是毫无意义的，服务器的计算资源是浪费，无端端的增加数据库的压力， 这就是所谓的缓存击穿， 如果请求量大，或者有人恶意攻击，数据库负载会增加， 甚至宕机。

要避免这种情况其实很简单， 即使这个key在数据库中查不到值，也在缓存中给它设置一个值即可。 那当数据库中存在这个key的值时如和更新这个缓存项呢？ 这很简单，方法也有很多，比如说给这个缓存项设置一个较短的过期时间，或者在后台运行一个线程，不停的轮询检查这个缓存项对应在数据库中是否存在数据即可。 